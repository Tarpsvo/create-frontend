# Create Frontend

This toolkit generates your project's frontend build system. It uses Webpack
under the hood.

## Features

* JS (Babel, Eslint, Babel-Polyfill, Flow, JSX). Can import relative to project
  root: `import x from 'client/js/y'`
* SCSS with autoprefixer, normalize.css
* Hot reload for development
* Works with zero configuration, but customization is possible if needed
* Usable with any backend.
* `.html` files are built from `/client/html` by default, with assets automatically linked.
* Can configure any files to be automatically copied to the public directory

## Usage

1. In Bash, navigate into your project directory
2. Type `npx @optimistdigital/create-frontend` and follow the instructions. You may also specify flags:
    - `--template=react` - Generates a React boilerplate
    - `-y` - Skips user confirmation (assume yes)

### CLI

* `npm run dev` - Start a webpack server for development
* `npm run build` - Build assets for production
* `npm run build:debug` - Build assets with debug logs. In JS, `__DEBUG__` will
  be [transformed](https://webpack.js.org/plugins/define-plugin/) to `true`

There are also flags to customize the dev environment:

* `npm run dev -- --webpackPort=8000` - Custom port for dev server
* `npm run dev -- --webpackDomain=localhost` - Custom domain for dev server
* `npm run dev -- --protocol=https` - Run the dev server with https

### Configuration

Configuration goes in the your package.json under the `create-frontend` field
(default in parens):

* `publicDirectory` (_public_) - Project's public root. Relative to project
  root.
* `buildPath` (_build_) - Where the build files will go. Relative to the public
  directory.
* `hashFileNames` (_true_) - Whether or not filenames should be hashed in
  production (e.g `app-503dcc37.js`). An `asset-manifest.json` file will be
  generated either way.
* `htmlPath` (_client/html_) - Html files from this directory will be built 
  into the public directory with [html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin).
* `copyPath` (_null_) - Files in this directory will be copied to the public directory. If not specified, files will not be copied.
* `htmlOptions` (_{}_) - Options that will get passed to html-webpack-plugin
* `entryPoints` - Object/string/array that contains the
  [entry points](https://webpack.js.org/concepts/entry-points/) for your
  application. Relative to project root. Default:
  ```js
  {
      app: 'client/js/entry.js',
  }
  ```

### Adding custom webpack rules / plugins

To configure the webpack rules and plugins, you can create a
`create-frontend.conf.js` file to the project root and export an object like
this:

```js
module.exports = {
  appendPlugins: opts => [],
  prependRules: opts => [],
  editConfig: (config, opts) => config,
  editDevServerConfig: (config, opts) => config,
};
```
* `appendPlugins` - Function that returns an array of plugins. Appended to the end
  of the plugins array.
* `prependRules` - Function that returns an array of rules. The first one to match
  will be used
  ([oneOf](https://webpack.js.org/configuration/module/#rule-oneof)). These take precedence over default rules - if your custom rule matches, the default ones will not be used.
* `editConfig` - Function that can be used to return a customized version of the webpack config.
First argument is the webpack config that is generated by Create Frontend. Use this as an escape hatch to customize the webpack config directly.
* `editDevServerConfig` - Function that can be used to return a customized version of the [webpack dev server config](https://webpack.js.org/configuration/dev-server/). 

The `opts` parameter contains the following object: `{ IS_PRODUCTION: boolean, paths: Object, config: Object }`

### Using hot module replacement

[Hot module replacement](https://webpack.js.org/api/hot-module-replacement/) is
enabled for the app, however you must choose manually what you want to update
when changes are made. To do this, go into your `entry.js` file and uncomment
the relevant code.

## Updating

To update the local version of the toolkit, type `npm install @optimistdigital/create-frontend`. Please look at the changelog to see if there are any breaking changes.

The global version can be updated with `npm install -g @optimistdigital/create-frontend`, and will ensure that newly created projects use the latest version.

